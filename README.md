<div align="center">

# ğŸ§  æ™ºèƒ½LLMåˆ¤æ–­ (Smart Judge)

[![AstrBot](https://img.shields.io/badge/AstrBot-Plugin-purple)](https://github.com/Soulter/AstrBot)
[![License](https://img.shields.io/badge/license-MIT-green)](./LICENSE)
[![Python](https://img.shields.io/badge/python-3.6+-blue)](https://www.python.org/)

**è®©æ¯ä¸€åˆ†Tokenéƒ½èŠ±åœ¨åˆ€åˆƒä¸Š**

æ™ºèƒ½åˆ†æç”¨æˆ·æ„å›¾ â€¢ åŠ¨æ€è·¯ç”±æ¨¡å‹ â€¢ é™ä½APIæˆæœ¬ â€¢ æå‡å“åº”é€Ÿåº¦

</div>

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ§  æ™ºèƒ½åˆ†æµ**ï¼šè‡ªåŠ¨è¯†åˆ«"å¼±æ™º"é—®é¢˜ä¸"çƒ§è„‘"é—®é¢˜ï¼Œåˆ†åˆ«è·¯ç”±è‡³å¿«é€Ÿæ¨¡å‹æˆ–é«˜æ™ºå•†æ¨¡å‹ã€‚
- **âš–ï¸ è´Ÿè½½å‡è¡¡**ï¼šæ”¯æŒé…ç½®å¤šä¸ªé«˜æ™ºå•†æ¨¡å‹æä¾›å•†ï¼Œéšæœº/è½®è¯¢è°ƒç”¨ï¼Œé¿å…å•ç‚¹æ•…éšœã€‚
- **ğŸ›¡ï¸ è§„åˆ™å…œåº•**ï¼šå½“åˆ¤æ–­æ¨¡å‹ä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨é™çº§ä¸ºå…³é”®è¯/æ­£åˆ™åŒ¹é…æ¨¡å¼ã€‚
- **ğŸ’° é¢„ç®—æ§åˆ¶**ï¼šå†…ç½®æ¯æ—¥/æ¯æœˆé¢„ç®—é™åˆ¶ï¼Œé˜²æ­¢Tokenè¶…æ”¯ã€‚
- **ğŸ“ ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šæ”¯æŒæºå¸¦èŠå¤©è®°å½•è¿›è¡Œåˆ¤æ–­ï¼Œç†è§£æ›´ç²¾å‡†ã€‚
- **âš¡ é«˜æ•ˆç¼“å­˜**ï¼šè‡ªåŠ¨ç¼“å­˜ç›¸ä¼¼é—®é¢˜çš„åˆ¤æ–­ç»“æœï¼Œå‡å°‘é‡å¤å¼€é”€ã€‚

## ğŸ› ï¸ æŒ‡ä»¤åˆ—è¡¨

æ’ä»¶å®‰è£…åå³å¯è‡ªåŠ¨ç”Ÿæ•ˆã€‚ä»¥ä¸‹ä¸ºæŒ‡ä»¤åˆ—è¡¨ï¼ˆæ”¯æŒåˆ«åï¼‰ï¼š

| æŒ‡ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- |
| `/judge_status` | æŸ¥çœ‹æ’ä»¶çŠ¶æ€ | `/judge_status` |
| `/judge_stats` | æŸ¥çœ‹è·¯ç”±ä¸ LLM ç»Ÿè®¡ | `/judge_stats` |
| `/judge_health` | æ¢æµ‹æä¾›å•†å¥åº·åº¦/æ–­è·¯å™¨ | `/judge_health` |
| `/judge_explain` | è§£é‡Šæœ€è¿‘ä¸€æ¬¡è·¯ç”±å†³ç­– | `/judge_explain` |
| `/judge_rule` | å¢åˆ åˆ—å‡ºè‡ªå®šä¹‰å…³é”®è¯è§„åˆ™ | `/judge_rule list` |
| `/judge_dryrun` | æ¨¡æ‹Ÿä¸€æ®µæ¶ˆæ¯å°†å¦‚ä½•è·¯ç”± | `/judge_dryrun å¸®æˆ‘å†™ä¸ªä»£ç ` |
| `/judge_reload` | é‡è½½å¹¶å½’ä¸€åŒ–é…ç½® | `/judge_reload` |
| `/ask_high` | å¼ºåˆ¶èµ°é«˜æ™ºå•†æ±  | `/ask_high` |
| `/ask_fast` | å¼ºåˆ¶èµ°å¿«é€Ÿæ±  | `/ask_fast` |
| `/ask_smart` | æ™ºèƒ½åˆ¤å®šåè·¯ç”± | `/ask_smart` |

> ğŸ’¡ **æç¤º**ï¼šæ™®é€šç”¨æˆ·æ— éœ€è¾“å…¥ä»»ä½•æŒ‡ä»¤ï¼Œæ­£å¸¸å¯¹è¯å³å¯äº«å—æ™ºèƒ½è·¯ç”±æœåŠ¡ã€‚

## âš™ï¸ é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶ä½äº `data/plugins/astrbot_plugin_judge/config.json`ã€‚

### æ ¸å¿ƒé…ç½®

| é…ç½®é¡¹ | è¯´æ˜ | æ¨èå€¼ |
| :--- | :--- | :--- |
| `judge_provider_id` | **[å¿…å¡«]** åˆ¤æ–­æ¨¡å‹æä¾›å•†ID | `openai` / `anthropic` ç­‰ |
| `judge_model` | åˆ¤æ–­æ¨¡å‹åç§°(å¯é€‰) | `gpt-4o-mini` ç­‰ |
| `high_iq_provider_ids` | é«˜æ™ºå•†æ¨¡å‹æä¾›å•†åˆ—è¡¨ | `["openai","anthropic"]` |
| `high_iq_models` | ä¸é«˜æ™ºå•†æä¾›å•†ä¸€ä¸€å¯¹åº”çš„æ¨¡å‹ååˆ—è¡¨ | `["gpt-4o","claude-3-opus"]` |
| `fast_provider_ids` | å¿«é€Ÿæ¨¡å‹æä¾›å•†åˆ—è¡¨ | `["openai","google"]` |
| `fast_models` | ä¸å¿«é€Ÿæä¾›å•†ä¸€ä¸€å¯¹åº”çš„æ¨¡å‹ååˆ—è¡¨ | `["gpt-4o-mini","gemini-1.5-flash"]` |

> å»ºè®®ä¼˜å…ˆä½¿ç”¨æ›´ç¨³å¥çš„é…å¯¹é…ç½®ï¼š`high_iq_routes` / `fast_routes`ï¼ˆä¾‹å¦‚ `"openai:gpt-4o"`ï¼‰ï¼Œé¿å… provider/models ä¸¤ä¸ªåˆ—è¡¨çš„ç´¢å¼•å¯¹é½è„†å¼±é—®é¢˜ã€‚

### é«˜çº§åŠŸèƒ½

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
| :--- | :--- | :--- |
| `enable_high_iq_polling` | é«˜æ™ºå•†æ± æ˜¯å¦è½®è¯¢é€‰æ‹© | `true` |
| `enable_rule_prejudge` | å¯ç”¨è§„åˆ™é¢„åˆ¤(å‡å°‘åˆ¤æ–­æ¨¡å‹è°ƒç”¨) | `true` |
| `enable_decision_cache` | å¯ç”¨å†³ç­–ç¼“å­˜ | `true` |
| `decision_cache_ttl_seconds` | å†³ç­–ç¼“å­˜ TTL(ç§’) | `600` |
| `enable_answer_cache` | å¯ç”¨å‘½ä»¤å›ç­”ç¼“å­˜ | `false` |
| `answer_cache_ttl_seconds` | å›ç­”ç¼“å­˜ TTL(ç§’) | `300` |

## â“ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆæ’ä»¶æ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ**
> A: è¯·å…ˆç”¨ `/judge_status` æŸ¥çœ‹çŠ¶æ€ï¼Œå¹¶æ£€æŸ¥ `judge_provider_id` æ˜¯å¦å·²é…ç½®ã€‚

**Q: å¦‚ä½•è‡ªå®šä¹‰åˆ¤æ–­é€»è¾‘ï¼Ÿ**
> A: å¯é€šè¿‡é…ç½® `custom_high_keywords` / `custom_fast_keywords` æˆ–ä½¿ç”¨ `/judge_rule` å‘½ä»¤åŠ¨æ€å¢åˆ å…³é”®è¯è§„åˆ™ã€‚

**Q: é¢„ç®—è€—å°½äº†æ€ä¹ˆåŠï¼Ÿ**
> A: æ’ä»¶ä¼šåœ¨é¢„ç®—æ§åˆ¶å¯ç”¨æ—¶æŒ‰æ¨¡å¼é™çº§ä¸º FASTï¼›å¯è°ƒæ•´é¢„ç®—ç›¸å…³é…ç½®åä½¿ç”¨ `/judge_reload` ä½¿å…¶ç”Ÿæ•ˆã€‚

---

<div align="center">
Made with â¤ï¸ for AstrBot
</div>
